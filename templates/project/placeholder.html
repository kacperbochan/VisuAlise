




<div class="col-md-3">
    <div class="container" style="border: 1px solid black; background-color: darkgray; height: 40em;">
        
        <div id="main-image-container" class="row mb-3 d-flex justify-content-center align-items-center mx-auto" style="height: 32em;">
            <img id="main-image" src="/static/default_character.png" alt="Selected Image" class="img-fluid" style="object-fit: contain; max-height: 100%;">
        </div>
        <div id="thumbnail-gallery" class="row flex-row flex-nowrap d-flex align-items-center" style="background-color: gray; height: 8em;">
            <!-- Thumbnails will be inserted here with Bootstrap classes -->
        </div>
    </div> 
</div>

async function fetchImages() {
    const response = await fetch('/images/');
    const imagePaths = await response.json();
    const gallery = document.getElementById('thumbnail-gallery');
    gallery.innerHTML = ''; // Clear the gallery
    imagePaths.forEach((path) => {
        const img = document.createElement('img');
        img.src = path;
        img.classList.add('thumbnail', 'img-thumbnail');
        img.setAttribute('data-full-img', path); // Assuming the full image is the same as the thumbnail
        img.style.objectFit = 'contain'; // Make the image fit into the box while maintaining aspect ratio
        img.style.width = '64px'; // Set the width to 64px
        img.style.height = '64px'; // Set the height to 64px
        gallery.appendChild(img);
    });
    document.getElementById('main-image').src = imagePaths.length > 0 ? imagePaths[0] : '/static/default_character.png';
}

// Event listener for thumbnail clicks
document.getElementById('thumbnail-gallery').addEventListener('click', function(e) {
    if (e.target.classList.contains('thumbnail')) {
        const newSrc = e.target.getAttribute('data-full-img');
        document.getElementById('main-image').src = newSrc;
    }
});

// Call fetchImages on page load to populate the gallery
fetchImages();


@router.get("/{project_name}/characters/{character_id}/{sub_page}")
async def read_character(request: Request, project_name: str, character_id: str, sub_page: str):
    
    project, project_path = get_project_by_name(project_name)
    visual_settings = get_visual_settings()
    return templates.TemplateResponse("character/character_base.html", {
        "request": request,
        "project": project,
        "sub_page": sub_page,
        "name":character_id,
        **visual_settings
    })